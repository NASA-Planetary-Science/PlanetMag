<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matlab supporting functions &mdash; PlanetMag v1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/PlanetMag_logo.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=0ec76b63"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "TeX": {"extensions": ["mhchem.js", "unicode.js"], "Macros": {"upalpha": "\\unicode{945}", "upbeta": "\\unicode{946}", "upgamma": "\\unicode{947}", "updelta": "\\unicode{948}", "upepsilon": "\\unicode{949}", "upzeta": "\\unicode{950}", "upeta": "\\unicode{951}", "uptheta": "\\unicode{952}", "upiota": "\\unicode{953}", "upkappa": "\\unicode{954}", "uplambda": "\\unicode{955}", "upmu": "\\unicode{956}", "upnu": "\\unicode{957}", "upxi": "\\unicode{958}", "upomicron": "\\unicode{959}", "uppi": "\\unicode{960}", "uprho": "\\unicode{961}", "upsigma": "\\unicode{963}", "uptau": "\\unicode{964}", "upupsilon": "\\unicode{965}", "upphi": "\\unicode{x03d5}", "upvarphi": "\\unicode{966}", "upchi": "\\unicode{967}", "uppsi": "\\unicode{968}", "upomega": "\\unicode{969}", "upAlpha": "\\unicode{913}", "upBeta": "\\unicode{914}", "upGamma": "\\unicode{915}", "upDelta": "\\unicode{916}", "upEpsilon": "\\unicode{917}", "upZeta": "\\unicode{918}", "upEta": "\\unicode{919}", "upTheta": "\\unicode{920}", "upIota": "\\unicode{921}", "upKappa": "\\unicode{922}", "upLambda": "\\unicode{923}", "upMu": "\\unicode{924}", "upNu": "\\unicode{925}", "upXi": "\\unicode{926}", "upOmicron": "\\unicode{927}", "upPi": "\\unicode{928}", "upRho": "\\unicode{929}", "upSigma": "\\unicode{931}", "upTau": "\\unicode{932}", "upUpsilon": "\\unicode{933}", "upPhi": "\\unicode{934}", "upChi": "\\unicode{935}", "upPsi": "\\unicode{936}", "upOmega": "\\unicode{937}"}}, "HTML-CSS": {"fonts": ["STIX-Web"]}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PlanetMag Python documentation" href="pythonModules.html" />
    <link rel="prev" title="PlanetMag Matlab run scripts" href="primary.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html">
            
              <img src="_static/PlanetMag_logoDocs.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="primary.html">PlanetMag Matlab run scripts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Matlab supporting functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#calculation-functions">Calculation functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#magfldparent"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">MagFldParent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ksmagfldjupiter"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">KSMagFldJupiter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mpausefld"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">MpauseFld()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#magfldparentsingle"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">MagFldParentSingle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icadecomposition"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ICAdecomposition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#legendres"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">LegendreS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dlegendres"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dLegendreS()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#additional-supporting-functions">Additional supporting functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bsph2bxyz"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">Bsph2Bxyz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bxyz2bsph"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">Bxyz2Bsph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#convertswarmcdf"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ConvertSwarmCDF()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#excitationspectrum"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ExcitationSpectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getbodyparams"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBodyParams()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getbplotandlsq"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBplotAndLsq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getbplotandlsqmoon"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBplotAndLsqMoon()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getbplotandlsqneptune"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBplotAndLsqNeptune()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getexcitations"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetExcitations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getgausscoeffs"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetGaussCoeffs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getmodelopts"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getminmoondist"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetMinMoonDist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#getposspice"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetPosSpice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gettargetmoondist"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetTargetMoonDist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#loadspice"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">LoadSpice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lshelltrace"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">LshellTrace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotspectrum"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">PlotSpectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rotatevecspice"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">RotateVecSpice()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-modelCoeffs.printIGRFcoeffs">Model coefficient functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#modelCoeffs.printIGRFcoeffs.printIGRFcoeffs"><code class="docutils literal notranslate"><span class="pre">printIGRFcoeffs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#coeffsbode1994g"><code class="xref py py-func docutils literal notranslate"><span class="pre">coeffsBode1994G()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pythonModules.html">PlanetMag Python documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PlanetMag</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Matlab supporting functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="matlab-supporting-functions">
<h1>Matlab supporting functions<a class="headerlink" href="#matlab-supporting-functions" title="Permalink to this heading"></a></h1>
<section id="calculation-functions">
<h2>Calculation functions<a class="headerlink" href="#calculation-functions" title="Permalink to this heading"></a></h2>
<section id="magfldparent">
<h3><a class="reference internal" href="#functions.MagFldParent" title="functions.MagFldParent"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">MagFldParent()</span></code></a><a class="headerlink" href="#magfldparent" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.MagFldParent">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">MagFldParent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">planet</span></em>, <em class="sig-param"><span class="pre">r_km</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">InternalFieldModel</span></em>, <em class="sig-param"><span class="pre">ExternalFieldModel</span></em>, <em class="sig-param"><span class="pre">magPhase_deg</span></em>, <em class="sig-param"><span class="pre">SPHOUT</span></em>, <em class="sig-param"><span class="pre">Nmaxin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.MagFldParent" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the magnetic field of the desired planet at specified locations according to the
specified internal and external field models.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The standard reference frames used for each body, except as noted below, are IAU_BODY. The only
exceptions to this rule are:</p>
<ul class="simple">
<li><p>Uranus uses the US3 frame: System III coordinates with +z along the spin pole, opposite the
direction of IAU_URANUS.</p></li>
<li><p>Neptune uses the NLS frame: The Neptune Longitude System derived from magnetic data.
IAU_NEPTUNE is a System II coordinate system that rotates with a stable atmospheric feature
at a different rate than the magnetic rotation rate inferred from Voyager 2 data.</p></li>
</ul>
<p>All standard frames rotate with the body (planet or moon).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planet</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of the planet for which to evaluate the field.</p></li>
<li><p><strong>r_km</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Radius of evaluation points in km from planet barycenter.</p></li>
<li><p><strong>theta</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Planetocentric colatitude of evaluation points in radians. Must be the same length as r_km.</p></li>
<li><p><strong>phi</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Planetocentric east longitude of evaluation points in radians. Must be the same length as r_km.</p></li>
<li><p><strong>InternalFieldModel</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Code name for planetary intrinsic field model to evaluate. Refer to <code class="xref py py-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code> for a listing
of valid options. Also accepts the special option <code class="docutils literal notranslate"><span class="pre">'None'</span></code>, which skips evaluation of the
intrinsic field model.</p></li>
<li><p><strong>ExternalFieldModel</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE</span></code></span>) – Code name for current sheet field model to evaluate. Refer to <code class="xref py py-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code> for a listing of
valid options. Also accepts the special option <code class="docutils literal notranslate"><span class="pre">'None'</span></code>, which skips evaluation of the
current sheet field model.</p></li>
<li><p><strong>magPhase_deg</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">default=0</span></code></span>) – Arbitrary offset in degrees by which to rotate the magnetospheric field evaluation.</p></li>
<li><p><strong>SPHOUT</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to return vectors aligned to spherical coordinate axes (true) or cartesian (false).</p></li>
<li><p><strong>Nmaxin</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int,</span> <span class="pre">default=Inf</span></code></span>) – Maximum degree to which to limit intrinsic field models. Only has an effect if the value passed
is less than the lesser of the model maximum degree and the maximum implemented in spherical
harmonic calculations (currently 10).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Bvec_nT</strong> (<em>double, 3xN</em>) – Magnetic field vector in standard coordinates (typically IAU or spherical coordinates if SPHOUT
is true) at evaluation points in nT. Output rows are x, y, z respectively for cartesian or r,
theta, phi for spherical.</p></li>
<li><p><strong>Mdip_nT</strong> (<em>double, 1x3</em>) – Dipole magnetic moment in standard cartesian coordinates, as surface-equivalent nT, i.e. this
value times the planet volume yields the magnetic moment in SI units.</p></li>
<li><p><strong>Odip_km</strong> (<em>double, 1x3</em>) – Dipole magnetic moment offset in km from planet barycenter in standard cartesian coordinates.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="ksmagfldjupiter">
<h3><a class="reference internal" href="#functions.KSMagFldJupiter" title="functions.KSMagFldJupiter"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">KSMagFldJupiter()</span></code></a><a class="headerlink" href="#ksmagfldjupiter" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.KSMagFldJupiter">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">KSMagFldJupiter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">r_km</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">SPHOUT</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.KSMagFldJupiter" title="Permalink to this definition"></a></dt>
<dd><p>Calculate magnetic field vectors, magnetic dipole moment,
and dipole offset in System III coordinates based on VIP4
Jupiter field model, plus the latest evolution of the Khurana
current sheet model from K. Khurana.</p>
</dd></dl>

</section>
<section id="mpausefld">
<h3><a class="reference internal" href="#functions.MpauseFld" title="functions.MpauseFld"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">MpauseFld()</span></code></a><a class="headerlink" href="#mpausefld" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.MpauseFld">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">MpauseFld</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nSW_pcc</span></em>, <em class="sig-param"><span class="pre">vSW_kms</span></em>, <em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">xyz_km</span></em>, <em class="sig-param"><span class="pre">Mdip_nT</span></em>, <em class="sig-param"><span class="pre">Odip_km</span></em>, <em class="sig-param"><span class="pre">S3coords</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">MPmodel</span></em>, <em class="sig-param"><span class="pre">SPHOUT</span></em>, <em class="sig-param"><span class="pre">Nmax</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.MpauseFld" title="Permalink to this definition"></a></dt>
<dd><p>SPHOUT : bool, default=0
Whether to return vectors aligned to spherical coordinate axes (true) or cartesian (false).</p>
</dd></dl>

</section>
<section id="magfldparentsingle">
<h3><a class="reference internal" href="#functions.MagFldParentSingle" title="functions.MagFldParentSingle"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">MagFldParentSingle()</span></code></a><a class="headerlink" href="#magfldparentsingle" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.MagFldParentSingle">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">MagFldParentSingle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">g</span></em>, <em class="sig-param"><span class="pre">h</span></em>, <em class="sig-param"><span class="pre">r_km</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">PlanetEqRadius</span></em>, <em class="sig-param"><span class="pre">InternalFieldModel</span></em>, <em class="sig-param"><span class="pre">ExternalFieldModel</span></em>, <em class="sig-param"><span class="pre">magPhase_deg</span></em>, <em class="sig-param"><span class="pre">Nmax</span></em>, <em class="sig-param"><span class="pre">NmaxExt</span></em>, <em class="sig-param"><span class="pre">SPHOUT</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.MagFldParentSingle" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the magnetic field of the desired planet at specified locations according to the
specified internal and external field models.</p>
<p>See MagFldPlanet for additional notes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">(Nmax)x(Nmax+1)</span></code></span>) – Internal field g coefficients in Schmidt normalization in G.</p></li>
<li><p><strong>h</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">(Nmax)x(Nmax+1)</span></code></span>) – Internal field h coefficients in Schmidt normalization in G.</p></li>
<li><p><strong>r_km</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double</span></code></span>) – Radius of evaluation point in km from planet barycenter.</p></li>
<li><p><strong>theta</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double</span></code></span>) – Planetocentric colatitude of evaluation points in radians.</p></li>
<li><p><strong>phi</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double</span></code></span>) – Planetocentric east longitude of evaluation point in radians.</p></li>
<li><p><strong>PlanetEqRadius</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double</span></code></span>) – Equatorial radius of planet in km associated with input <code class="docutils literal notranslate"><span class="pre">g</span></code> and <code class="docutils literal notranslate"><span class="pre">h</span></code> values.</p></li>
<li><p><strong>InternalFieldModel</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Code name for planetary intrinsic field model to evaluate. Refer to <code class="xref py py-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code> for a listing
of valid options. Also accepts the special option <code class="docutils literal notranslate"><span class="pre">'None'</span></code>, which skips evaluation of the
intrinsic field model.</p></li>
<li><p><strong>ExternalFieldModel</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE</span></code></span>) – Code name for current sheet field model to evaluate. Refer to <code class="xref py py-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code> for a listing of
valid options. Also accepts the special option <code class="docutils literal notranslate"><span class="pre">'None'</span></code>, which skips evaluation of the
current sheet field model.</p></li>
<li><p><strong>magPhase_deg</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">default=0</span></code></span>) – Arbitrary offset in degrees by which to rotate the magnetospheric field evaluation.</p></li>
<li><p><strong>Nmax</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int,</span> <span class="pre">default=Inf</span></code></span>) – Maximum degree to which to limit intrinsic field models. Only has an effect if the value passed
is less than the lesser of the model maximum degree and the maximum implemented in spherical
harmonic calculations (currently 10).</p></li>
<li><p><strong>NmaxExt</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int,</span> <span class="pre">default=Inf</span></code></span>) – Maximum degree to which to limit external field models. Only has an effect if the value passed
is less than the lesser of the model maximum degree and the maximum implemented in external
field calculations (currently 1).</p></li>
<li><p><strong>SPHOUT</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to return vectors aligned to spherical coordinate axes (true) or cartesian (false).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Bvec_nT</strong> – Magnetic field vector in standard coordinates (typically IAU or spherical coordinates if SPHOUT
is true) at evaluation points in nT. Output rows are x, y, z respectively for cartesian or r,
theta, phi for spherical.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 3x1</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="icadecomposition">
<h3><a class="reference internal" href="#functions.ICAdecomposition" title="functions.ICAdecomposition"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ICAdecomposition()</span></code></a><a class="headerlink" href="#icadecomposition" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.ICAdecomposition">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">ICAdecomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">Bvec</span></em>, <em class="sig-param"><span class="pre">descrip</span></em>, <em class="sig-param"><span class="pre">SPHOUT</span></em>, <em class="sig-param"><span class="pre">PLOT_DIAGNOSTIC</span></em>, <em class="sig-param"><span class="pre">COMPARE_SEUFERT</span></em>, <em class="sig-param"><span class="pre">LIVE_PLOTS</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.ICAdecomposition" title="Permalink to this definition"></a></dt>
<dd><p>Decomposes the input magnetic field vector time series into complex excitation moments using
<em class="dfn">Independent Component Analysis (ICA)</em>.</p>
<p>The methodology applied to invert the imput magnetic field vector time series <code class="docutils literal notranslate"><span class="pre">Bvec</span></code> for its
complex excitation moments (the independent components of ICA) is described in detail in Hyvarinen
and Oja (2000) <a class="reference external" href="https://doi.org/10.1016/S0893-6080(00)00026-5">https://doi.org/10.1016/S0893-6080(00)00026-5</a>. In this method, the expected signal
components <span class="math notranslate nohighlight">\(\mathbf{s} = (s_1, \dots, s_p)\)</span> are found from the input measurements
<span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, \dots, x_n)\)</span> by inverting the estimated mixing matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>
and multiplying <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> by the input time series, where
<span class="math notranslate nohighlight">\(\mathbf{x} = \mathbf{As}\)</span>. The signal components <span class="math notranslate nohighlight">\(\mathbf{s}_j\)</span> for vector component
<span class="math notranslate nohighlight">\(j\)</span> in our case are a list of cos and sin waves, representing the real and imaginary parts
of <span class="math notranslate nohighlight">\(e^{-i\omega_k t}\)</span> respectively, oscillating with the expected frequencies
<span class="math notranslate nohighlight">\(\mathbf{f} = (f_1, \dots, f_p)\)</span>, evaluated at each ephemeris time in the input time series
<code class="docutils literal notranslate"><span class="pre">ets</span></code>, and weighted by the excitation moments <span class="math notranslate nohighlight">\(\mathbf{B}_j^e\)</span>. Each unweighted signal
component comprises a column of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. The eigenvectors of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> are the
columns of the weight matrix <span class="math notranslate nohighlight">\(\mathbf{W} = (\mathbf{X}^T\mathbf{X})^{-1}\)</span>. We find the
excitation moments from</p>
<div class="math notranslate nohighlight">
\[\mathbf{B}_j^e = \mathbf{B}_j\mathbf{XW},\]</div>
<p>with each element <span class="math notranslate nohighlight">\(B_{jk}^e\)</span> corresponding to a real (cos) or imaginary (sin) wave with
frequency <span class="math notranslate nohighlight">\(f_k\)</span>. The complex excitation moments are constructed by combining the real and
imaginary parts for each <span class="math notranslate nohighlight">\(f_k\)</span>, and the reproduced time series is found by taking the real
part of</p>
<div class="math notranslate nohighlight">
\[\tilde{B}_j(t) = \sum_k \tilde{B}_{jk}^e e^{-i\omega_k t},\]</div>
<p>or for the input time series</p>
<div class="math notranslate nohighlight">
\[\tilde{\mathbf{B}}_j = \mathbf{X}(\mathbf{B}_j^e)^T,\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{B}\)</span> denotes a complex magnetic field quantity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of moon for which to evaluate excitation moments.</p></li>
<li><p><strong>parentName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Name of parent planet for the moon for which to evaluate excitation moments.</p></li>
<li><p><strong>ets</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Ephemeris times associated with input time series magnetic field vectors in TDB seconds relative
to J2000.</p></li>
<li><p><strong>Bvec</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">3xN</span></code></span>) – Magnetic field vectors at each measurement time.</p></li>
<li><p><strong>descrip</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE</span></code></span>) – Text description of the magnetic field model that was evalauted for the input time series.</p></li>
<li><p><strong>SPHOUT</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to return vectors aligned to spherical coordinate axes (true) or cartesian (false).</p></li>
<li><p><strong>PLOT_DIAGNOSTIC</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=1</span></code></span>) – Whether to plot comparisons between the input and reproduced time series.</p></li>
<li><p><strong>COMPARE_SEUFERT</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to plot coordinate directions aligned to the axes presented in Seufert et al. (2011)
<a class="reference external" href="https://doi.org/10.1016/j.icarus.2011.03.017">https://doi.org/10.1016/j.icarus.2011.03.017</a>. Only has an effect when <code class="docutils literal notranslate"><span class="pre">SPHOUT</span></code> is true,
because Seufert et al. used spherical coordinates for evaluating the excitation spectra of
Jupiter’s moons.</p></li>
<li><p><strong>LIVE_PLOTS</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to load interactive figure windows for plots (true) or print them to disk (false).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>BD</strong> –</p>
<p>Contains fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>f</strong> (<cite>double, 1xP</cite>) – Frequencies of estimated excitation moments in Hz.</p></li>
<li><p><strong>BexcVec1i</strong> (<cite>double, 1xP</cite>) – Real part (i for “in-phase”) of excitation moments for
vector component 1 (x or r) in nT.</p></li>
<li><p><strong>BexcVec1q</strong> (<cite>double, 1xP</cite>) – Imaginary part (q for “quadrature”) of excitation moments
for vector component 1 in nT.</p></li>
<li><p><strong>BexcVec1o</strong> (<cite>double</cite>) – Vector component 1 of uniform background field in nT.</p></li>
<li><p><strong>BexcVec2i</strong> (<cite>double, 1xP</cite>) – Real part (i for “in-phase”) of excitation moments for
vector component 2 (y or theta) in nT.</p></li>
<li><p><strong>BexcVec2q</strong> (<cite>double, 1xP</cite>) – Imaginary part (q for “quadrature”) of excitation moments
for vector component 2 in nT.</p></li>
<li><p><strong>BexcVec2o</strong> (<cite>double</cite>) – Vector component 2 of uniform background field in nT.</p></li>
<li><p><strong>BexcVec3i</strong> (<cite>double, 1xP</cite>) – Real part (i for “in-phase”) of excitation moments for
vector component 3 (z or phi) in nT.</p></li>
<li><p><strong>BexcVec3q</strong> (<cite>double, 1xP</cite>) – Imaginary part (q for “quadrature”) of excitation moments
for vector component 3 in nT.</p></li>
<li><p><strong>BexcVec3o</strong> (<cite>double</cite>) – Vector component 3 of uniform background field in nT.</p></li>
<li><p><strong>rmse</strong> (<cite>double</cite>) – Normalized root-mean-squared error calculated from comparing input
and reproduced time series data.</p></li>
<li><p><strong>Rsquared</strong> (<cite>double</cite>) – <span class="math notranslate nohighlight">\(R^2\)</span> value for the reproduced time series.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>struct</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="legendres">
<h3><a class="reference internal" href="#functions.LegendreS" title="functions.LegendreS"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">LegendreS()</span></code></a><a class="headerlink" href="#legendres" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.LegendreS">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">LegendreS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n</span></em>, <em class="sig-param"><span class="pre">m</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">UNNORM</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.LegendreS" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate Schmidt semi-normalized associated Legendre functions for a single n,m.</p>
<p>Returns the value of Schmidt semi-normalized associated Legendre functions <span class="math notranslate nohighlight">\(S_n^m\)</span> of
degree n and order m at a list of colatitudes theta. The Condon–Shortley phase is omitted.
The Schmidt normalization is</p>
<div class="math notranslate nohighlight">
\[S_n^m(\theta) = \sqrt{(2 - \delta_{m0})\frac{(n-m)!}{(n+m)!}} P_n^m(\cos\theta)\]</div>
<p>where <span class="math notranslate nohighlight">\(P_n^m\)</span> are the unnormalized associated Legendre functions without the
Condon–Shortley phase and <span class="math notranslate nohighlight">\(\delta_{m,m'}\)</span> is the Kronecker delta function, which is 0
unless <span class="math notranslate nohighlight">\(m = m'\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – Degree n and order m for which to evaluate Legendre functions.</p></li>
<li><p><strong>m</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – Degree n and order m for which to evaluate Legendre functions.</p></li>
<li><p><strong>theta</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Colatitudes in radians at which to evaluate Legendre functions.</p></li>
<li><p><strong>UNNORM</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to return <strong>un</strong>-normalized associated Legendre functions <span class="math notranslate nohighlight">\(P_n^m(\cos\theta)\)</span>.
As with the default, semi-normalized <span class="math notranslate nohighlight">\(S_n^m\)</span>, the Condon–Shortley phase is omitted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Snm</strong> – Schmidt semi-normalized associated Legendre function evaluation at given colatitudes for the
specified n,m.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="dlegendres">
<h3><a class="reference internal" href="#functions.dLegendreS" title="functions.dLegendreS"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">dLegendreS()</span></code></a><a class="headerlink" href="#dlegendres" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.dLegendreS">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">dLegendreS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n</span></em>, <em class="sig-param"><span class="pre">m</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">UNNORM</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.dLegendreS" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the derivative of Schmidt semi-normalized associated Legendre functions for a single
n,m.</p>
<p>Returns the value of the <span class="math notranslate nohighlight">\(\theta\)</span> derivative of Schmidt semi-normalized associated Legendre
functions <span class="math notranslate nohighlight">\(\frac{dS_n^m}{d\theta}\)</span> of degree n and order m at a list of colatitudes theta.
The Condon–Shortley phase is omitted. See <code class="xref py py-func docutils literal notranslate"><span class="pre">LegendreS()</span></code> for more information on the normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – Degree n and order m for which to evaluate Legendre function derivatives.</p></li>
<li><p><strong>m</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – Degree n and order m for which to evaluate Legendre function derivatives.</p></li>
<li><p><strong>theta</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Colatitudes in radians at which to evaluate Legendre function derivatives.</p></li>
<li><p><strong>UNNORM</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to return <strong>un</strong>-normalized associated Legendre function derivatives
<span class="math notranslate nohighlight">\(\frac{dP_n^m(\cos\theta)}{d\theta}\)</span>. As with the default, the Condon–Shortley phase is
omitted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dSnm</strong> – Schmidt semi-normalized associated Legendre function derivative evaluation at given colatitudes
for the specified n,m.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="additional-supporting-functions">
<h2>Additional supporting functions<a class="headerlink" href="#additional-supporting-functions" title="Permalink to this heading"></a></h2>
<section id="bsph2bxyz">
<h3><a class="reference internal" href="#functions.Bsph2Bxyz" title="functions.Bsph2Bxyz"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">Bsph2Bxyz()</span></code></a><a class="headerlink" href="#bsph2bxyz" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.Bsph2Bxyz">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">Bsph2Bxyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Br</span></em>, <em class="sig-param"><span class="pre">Bth</span></em>, <em class="sig-param"><span class="pre">Bphi</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.Bsph2Bxyz" title="Permalink to this definition"></a></dt>
<dd><p>Convert spherical (r, theta, phi) vector to cartesian (x, y, z) vector.</p>
<p>Convert vector components aligned to spherical coordinates into vector components aligned to
cartesian axes.
Source: Arfken, Weber, Harris, Mathematical Methods for Physicists, 7th ed, pg. 199 for the unit
vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Br</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Radial (<span class="math notranslate nohighlight">\(\hat{r}\)</span>) component of vectors to be converted.</p></li>
<li><p><strong>Bth</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Colatitudinal (<span class="math notranslate nohighlight">\(\hat{\theta}\)</span>) component of vectors to be converted.</p></li>
<li><p><strong>Bphi</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Longitudinal (<span class="math notranslate nohighlight">\(\hat{\phi}\)</span>) component of vectors to be converted.</p></li>
<li><p><strong>theta</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Colatitude for each location associated with each (Br, Bth, Bphi) vector in radians.</p></li>
<li><p><strong>phi</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – East longitude for each location associated with each (Br, Bth, Bphi) vector in radians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Bx, By, Bz</strong> – x-, y-, and z-aligned components of converted vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="bxyz2bsph">
<h3><a class="reference internal" href="#functions.Bxyz2Bsph" title="functions.Bxyz2Bsph"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">Bxyz2Bsph()</span></code></a><a class="headerlink" href="#bxyz2bsph" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.Bxyz2Bsph">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">Bxyz2Bsph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Bx</span></em>, <em class="sig-param"><span class="pre">By</span></em>, <em class="sig-param"><span class="pre">Bz</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.Bxyz2Bsph" title="Permalink to this definition"></a></dt>
<dd><p>Convert cartesian (x, y, z) vector to spherical (r, theta, phi) vector.</p>
<p>Convert vector components aligned to cartesian axes into vector components aligned to spherical
coordinates.
Source: Arfken, Weber, Harris, Mathematical Methods for Physicists, 7th ed, pg. 199 for the unit
vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Bx</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – x-aligned component of vectors to be converted.</p></li>
<li><p><strong>By</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – y-aligned component of vectors to be converted.</p></li>
<li><p><strong>Bz</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – z-aligned component of vectors to be converted.</p></li>
<li><p><strong>theta</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Colatitude for each location associated with each (Bx, By, Bz) vector in radians.</p></li>
<li><p><strong>phi</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – East longitude for each location associated with each (Bx, By, Bz) vector in radians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Br, Bth, Bphi</strong> – Radial (<span class="math notranslate nohighlight">\(\hat{r}\)</span>), colatitudinal (<span class="math notranslate nohighlight">\(\hat{\theta}\)</span>), and azimuthal
(<span class="math notranslate nohighlight">\(\hat{\phi}\)</span>) components of converted vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="convertswarmcdf">
<h3><a class="reference internal" href="#functions.ConvertSwarmCDF" title="functions.ConvertSwarmCDF"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ConvertSwarmCDF()</span></code></a><a class="headerlink" href="#convertswarmcdf" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.ConvertSwarmCDF">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">ConvertSwarmCDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fNameIn</span></em>, <em class="sig-param"><span class="pre">fNameOut</span></em>, <em class="sig-param"><span class="pre">fDir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.ConvertSwarmCDF" title="Permalink to this definition"></a></dt>
<dd><p>Convert magnetic field data files from the Swarm mission from CDF to ASCII text.</p>
<p>Converts CDF file containing Swarm data to .tab text file with positions and field vector
components aligned to the IAU_EARTH frame. Spice kernels must already be loaded (use
<code class="xref py py-func docutils literal notranslate"><span class="pre">LoadSpice()</span></code> with <code class="docutils literal notranslate"><span class="pre">'Earth',</span> <span class="pre">'Swarm'</span></code>). Note that all indices pertaining to timestamps,
locations, and measurement data and the corresponding coordinate systems must be set bespoke
to each CDF file. Converting this function to work with other missions’ data products will
require a careful examination of the second output from cdfread (info) and the ordering of the
contents in info.Variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fNameIn</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of .cdf input file.</p></li>
<li><p><strong>fNameOut</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Name of .tab output file.</p></li>
<li><p><strong>fDir</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE,</span> <span class="pre">default=fullfile('MAG',</span> <span class="pre">'Swarm')</span></code></span>) – Directory where input file is located and output file will be printed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="excitationspectrum">
<h3><a class="reference internal" href="#functions.ExcitationSpectrum" title="functions.ExcitationSpectrum"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">ExcitationSpectrum()</span></code></a><a class="headerlink" href="#excitationspectrum" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.ExcitationSpectrum">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">ExcitationSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">nOsc</span></em>, <em class="sig-param"><span class="pre">rate</span></em>, <em class="sig-param"><span class="pre">Tinterest_h</span></em>, <em class="sig-param"><span class="pre">outData</span></em>, <em class="sig-param"><span class="pre">fPatternFT</span></em>, <em class="sig-param"><span class="pre">fPatternTseries</span></em>, <em class="sig-param"><span class="pre">magPhase</span></em>, <em class="sig-param"><span class="pre">DO_EPO</span></em>, <em class="sig-param"><span class="pre">SPHOUT</span></em>, <em class="sig-param"><span class="pre">DO_MPAUSE</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.ExcitationSpectrum" title="Permalink to this definition"></a></dt>
<dd><p>Calculate a Fast Fourier Transform (FFT) spectrum of magnetic oscillations for a given moon.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although this function returns degree-1 complex excitation moments, these moments cannot be used
for reproducing the input time series for any period except Tinterest_h. This is because the phase
for each peak in the FFT can be tuned only based on the time step of the input time series—if a
given oscillation period does not cover a whole number of time steps, the calculated phase of the
complex peak amplitude in the FFT will drift.</p>
<p>For calculating excitation moments, instead use <code class="xref py py-func docutils literal notranslate"><span class="pre">ICAdecomposition()</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of target moon for which to calculate an excitation spectrum.</p></li>
<li><p><strong>nOsc</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int,</span> <span class="pre">default=5000</span></code></span>) – Number of oscillations of <code class="docutils literal notranslate"><span class="pre">Tinterest_h</span></code> over which to span the time series to transform.</p></li>
<li><p><strong>rate</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int,</span> <span class="pre">default=100</span></code></span>) – Number of time steps to use for each oscillation period.</p></li>
<li><p><strong>Tinterest_h</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">optional</span></code></span>) – Period of key magnetic oscillation to which to tune the FFT. The excitation moment for this
period is the one most accurately reproduced from the FFT inversion. The default value is the
synodic period, as evaluated from values returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">GetBodyParams()</span></code>.</p></li>
<li><p><strong>outData</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xF,</span> <span class="pre">default='out'</span></code></span>) – Directory to use for output of complex spectrum amplitudes.</p></li>
<li><p><strong>fPatternFT</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xG,</span> <span class="pre">default='FTdata'</span></code></span>) – Pattern for file names of FFT spectrum data saved to disk.</p></li>
<li><p><strong>fPatternTseries</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xH,</span> <span class="pre">default='TseriesData'</span></code></span>) – Pattern for file names of time series data saved to disk.</p></li>
<li><p><strong>magPhase</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">default=0</span></code></span>) – Arbitrary offset in radians by which to rotate the magnetospheric field evaluation.</p></li>
<li><p><strong>DO_EPO</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to perform calculations for Europa in EphiO coordinates (true) or cartesian (false).</p></li>
<li><p><strong>SPHOUT</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to return vectors aligned to spherical coordinate axes (true) or cartesian (false).</p></li>
<li><p><strong>DO_MPAUSE</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to include a magnetopause current magnetic field model in spectrum evaluation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Tpeak_h</strong> (<em>double, 1xP</em>) – Oscillation periods in hours associated with peaks in the excitation spectrum greater than 1 nT.</p></li>
<li><p><strong>B0vec</strong> (<em>double, 1x3</em>) – Background uniform magnetic field vector from evaluated time series.</p></li>
<li><p><strong>B1vec</strong> (<em>complex double, 3xP</em>) – Degree-1 complex excitation moments in the selected coordinates cooresponding to each peak in
<code class="docutils literal notranslate"><span class="pre">Tpeak_h</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="getbodyparams">
<h3><a class="reference internal" href="#functions.GetBodyParams" title="functions.GetBodyParams"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBodyParams()</span></code></a><a class="headerlink" href="#getbodyparams" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetBodyParams">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetBodyParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetBodyParams" title="Permalink to this definition"></a></dt>
<dd><p>Return physical properties of the target moon, its orbit, and the parent planet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – <p>Name of the target moon. Currently implemented options are:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'Moon'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Io'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Europa'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Ganymede'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Callisto'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Mimas'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Enceladus'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Dione'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Rhea'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Titan'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Miranda'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Ariel'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Umbriel'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Titania'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Oberon'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'Triton'</span></code></p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>planets.</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">and</span> <span class="pre">their</span> <span class="pre">parent</span></code></span>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>RparentEq_km</strong> (<em>double</em>) – Equatorial radius of the parent planet in km.</p></li>
<li><p><strong>RparentPol_km</strong> (<em>double</em>) – Polar radius of the parent planet in km.</p></li>
<li><p><strong>RmoonEq_km</strong> (<em>double</em>) – Equatorial radius of the target moon in km.</p></li>
<li><p><strong>a_AU</strong> (<em>double</em>) – Semimajor axis of the parent planet’s solar orbit in AU.</p></li>
<li><p><strong>omegaParent_radps</strong> (<em>double</em>) – Angular rotation rate of the parent planet in radians/s.</p></li>
<li><p><strong>omegaMoon_radps</strong> (<em>double</em>) – Angular rotation rate of the target moon in radians/s.</p></li>
<li><p><strong>Tparent_s</strong> (<em>double</em>) – Sidereal rotation period of the parent planet in s.</p></li>
<li><p><strong>Tmoon_s</strong> (<em>double</em>) – Sidereal rotation period of the target moon in s.</p></li>
<li><p><strong>nutPrecParent</strong> (<em>double, 1xN’</em>) – Nutation/precession rate coefficients as specified in the latest IAU report implemented in the
loaded PCK file. Size depends on the body and which rates are defined.</p></li>
<li><p><strong>nutPrecMoon</strong> (<em>double, 1xM’</em>) – Nutation/precession rate coefficients as specified in the latest IAU report implemented in the
loaded PCK file. Size depends on the body and which rates are defined.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="getbplotandlsq">
<h3><a class="reference internal" href="#functions.GetBplotAndLsq" title="functions.GetBplotAndLsq"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBplotAndLsq()</span></code></a><a class="headerlink" href="#getbplotandlsq" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetBplotAndLsq">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetBplotAndLsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">t_h</span></em>, <em class="sig-param"><span class="pre">r_km</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">xyz_km</span></em>, <em class="sig-param"><span class="pre">BrSC</span></em>, <em class="sig-param"><span class="pre">BthSC</span></em>, <em class="sig-param"><span class="pre">BphiSC</span></em>, <em class="sig-param"><span class="pre">scName</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">S3coords</span></em>, <em class="sig-param"><span class="pre">orbStr</span></em>, <em class="sig-param"><span class="pre">opt</span></em>, <em class="sig-param"><span class="pre">MPopt</span></em>, <em class="sig-param"><span class="pre">SEQUENTIAL</span></em>, <em class="sig-param"><span class="pre">jt_h</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetBplotAndLsq" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="getbplotandlsqmoon">
<h3><a class="reference internal" href="#functions.GetBplotAndLsqMoon" title="functions.GetBplotAndLsqMoon"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBplotAndLsqMoon()</span></code></a><a class="headerlink" href="#getbplotandlsqmoon" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetBplotAndLsqMoon">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetBplotAndLsqMoon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">t_h</span></em>, <em class="sig-param"><span class="pre">r_km</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">xyz_km</span></em>, <em class="sig-param"><span class="pre">r_RM</span></em>, <em class="sig-param"><span class="pre">BxSC</span></em>, <em class="sig-param"><span class="pre">BySC</span></em>, <em class="sig-param"><span class="pre">BzSC</span></em>, <em class="sig-param"><span class="pre">scName</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">S3coords</span></em>, <em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">era</span></em>, <em class="sig-param"><span class="pre">fbStr</span></em>, <em class="sig-param"><span class="pre">opt</span></em>, <em class="sig-param"><span class="pre">MPopt</span></em>, <em class="sig-param"><span class="pre">SEQUENTIAL</span></em>, <em class="sig-param"><span class="pre">jt_h</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetBplotAndLsqMoon" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="getbplotandlsqneptune">
<h3><a class="reference internal" href="#functions.GetBplotAndLsqNeptune" title="functions.GetBplotAndLsqNeptune"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetBplotAndLsqNeptune()</span></code></a><a class="headerlink" href="#getbplotandlsqneptune" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetBplotAndLsqNeptune">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetBplotAndLsqNeptune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">t_h</span></em>, <em class="sig-param"><span class="pre">r_km</span></em>, <em class="sig-param"><span class="pre">theta</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">xyz_km</span></em>, <em class="sig-param"><span class="pre">BrSC</span></em>, <em class="sig-param"><span class="pre">BthSC</span></em>, <em class="sig-param"><span class="pre">BphiSC</span></em>, <em class="sig-param"><span class="pre">scName</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">S3coords</span></em>, <em class="sig-param"><span class="pre">orbStr</span></em>, <em class="sig-param"><span class="pre">opt</span></em>, <em class="sig-param"><span class="pre">MPopt</span></em>, <em class="sig-param"><span class="pre">SEQUENTIAL</span></em>, <em class="sig-param"><span class="pre">exclude</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetBplotAndLsqNeptune" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="getexcitations">
<h3><a class="reference internal" href="#functions.GetExcitations" title="functions.GetExcitations"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetExcitations()</span></code></a><a class="headerlink" href="#getexcitations" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetExcitations">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetExcitations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">etMid_day</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetExcitations" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve a list of excitation frequencies to invert.</p>
<p>Returned excitation frequencies consist of combinations of precise orbital periods, including
those adjusted for nutation and precession. For most bodies, one or more empirically determined
oscillation periods are also included, such as those corresponding to the true anomaly period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of moon for which to return excitation frequencies.</p></li>
<li><p><strong>etMid_day</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">default=0</span></code></span>) – Ephemeris time (ET) near the center of time series to be evaluated in days. Default is J2000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f</strong> (<em>double, 1xP’</em>) – Frequencies of excitations in Hz.</p></li>
<li><p><strong>fSyn</strong> (<em>double</em>) – Frequency of synodic period oscillation in Hz.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="getgausscoeffs">
<h3><a class="reference internal" href="#functions.GetGaussCoeffs" title="functions.GetGaussCoeffs"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetGaussCoeffs()</span></code></a><a class="headerlink" href="#getgausscoeffs" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetGaussCoeffs">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetGaussCoeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">planet</span></em>, <em class="sig-param"><span class="pre">InternalFieldModel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetGaussCoeffs" title="Permalink to this definition"></a></dt>
<dd><p>Read spherical harmonic coefficients from formatted ASCII files on disk.</p>
<p>Spherical harmonic components for each model are returned in gauss, as are the maximum degree
implemented in the reported model and in PlanetMag and the planet reference radius in km used in
the spherical harmonic expansion, as reported in listed publication from which the coefficients
have been collected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planet</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Planet for which to load model coefficients. Options are the planets listed under
<code class="docutils literal notranslate"><span class="pre">InternalFieldModel</span></code>, as well as the special name <code class="docutils literal notranslate"><span class="pre">'PureHarmonic'</span></code>, which reads a register
file from disk that has a single g or h represented for a specific n,m pair, for testing and
validation purposes.</p></li>
<li><p><strong>InternalFieldModel</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – <p>Published spherical harmonic model for the desired planet. Currently implemented are:</p>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Earth</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldEarthIGRF13'</span></code>: “International Geomagnetic Reference Field: the thirteenth
generation.” <a class="reference external" href="https://doi.org/10.1186/s40623-020-01288-x">https://doi.org/10.1186/s40623-020-01288-x</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Jupiter</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldJupiterVIP4'</span></code>: “New models of Jupiter’s magnetic field constrained by the Io
flux tube footprint.” <a class="reference external" href="https://doi.org/10.1029/97JA03726">https://doi.org/10.1029/97JA03726</a>
(Voyager–Io footprint–Pioneer degree 4 model.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldJupiterGSFCO4'</span></code>: “The main magnetic field of Jupiter.”
<a class="reference external" href="https://doi.org/10.1029/JA081i016p02917">https://doi.org/10.1029/JA081i016p02917</a> The PlanetMag implementation is based on the
update to System III (1965) conventions by Connerney (1992):
<a class="reference external" href="https://core.ac.uk/download/pdf/83644007.pdf">https://core.ac.uk/download/pdf/83644007.pdf</a>. The model is named GSFC O4 after the
institution where it was developed (Goddard Spaceflight Center, GSFC) and that it
includes up to the octupole (degree 3) coefficients from a degree 4 expansion.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldJupiterGSFCO6'</span></code>: Coefficients as repoted in “Magnetic Fields of the Outer
Planets.” <a class="reference external" href="https://doi.org/10.1007/s11214-009-9621-7">https://doi.org/10.1007/s11214-009-9621-7</a>, though originally described in
Connerney (1992): <a class="reference external" href="https://core.ac.uk/download/pdf/83644007.pdf">https://core.ac.uk/download/pdf/83644007.pdf</a>. Also developed at
GSFC, this model includes the octupole coefficients from a degree 6 expansion, hence
the name O6.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldJupiterJRM09'</span></code>: “A New Model of Jupiter’s Magnetic Field From Juno’s First
Nine Orbits.” <a class="reference external" href="https://doi.org/10.1002/2018GL077312">https://doi.org/10.1002/2018GL077312</a> The Jupiter Reference Model
after 9 orbits by Juno.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldJupiterJRM33'</span></code>: “A New Model of Jupiter’s Magnetic Field at the Completion of
Juno’s Prime Mission.” <a class="reference external" href="https://doi.org/10.1029/2021JE007138">https://doi.org/10.1029/2021JE007138</a> The Jupiter Reference
Model after 33 orbits of Jupiter by Juno.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Saturn</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldSaturnBurton2010'</span></code>: “Saturn’s internal planetary magnetic field.”
<a class="reference external" href="https://doi.org/10.1029/2010GL045148">https://doi.org/10.1029/2010GL045148</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldSaturnCassini11'</span></code>: “Saturn’s magnetic field revealed by the Cassini Grand
Finale.” <a class="reference external" href="https://doi.org/10.1126/science.aat5434">https://doi.org/10.1126/science.aat5434</a>, corrected values at
<a class="reference external" href="https://doi.org/10.1126/science.aav6732">https://doi.org/10.1126/science.aav6732</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Uranus</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldUranusQ3'</span></code>: “The magnetic field of Uranus.”
<a class="reference external" href="https://doi.org/10.1029/JA092iA13p15329">https://doi.org/10.1029/JA092iA13p15329</a> The name Q3 comes from including only a
dipole and quadrupole moment in a degree-3 spherical harmonic expansion. This model
also includes degree-1 external field coefficients, i.e. a uniform background field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldUranusAH5'</span></code>: “Aurora and magnetic field of Uranus.”
<a class="reference external" href="https://doi.org/10.1029/2009JA014394">https://doi.org/10.1029/2009JA014394</a> AH5 stands for aurora hexadecapole L-shell = 5
model.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Neptune</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'MagFldNeptuneO8'</span></code>: “The magnetic field of Neptune.”
<a class="reference external" href="https://doi.org/10.1016/0273-1177(92)90394-D">https://doi.org/10.1016/0273-1177(92)90394-D</a> Named similarly to the Jupiter GSFC
models, the Neptune O8 model is a degree-8 expansion that retains only up to the
octupole moment.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>g, h</strong> (<em>double, (Nmax)x(Nmax+1)</em>) – Real spherical harmonic coefficients (Gauss coefficients) in Schmidt semi-normalized form for
the internal magnetic field of the planet in terms of surface field strength in gauss.
Coefficients are each referenced to a specific System III coordinate system: ITRF08 for Earth,
ULS for Uranus, NLS for Neptune, and IAU for Jupiter and Saturn. Refer to the listed
publications for more details.</p></li>
<li><p><strong>G, H</strong> (<em>double, (NmaxExt)x(NmaxExt+1)</em>) – Real spherical harmonic coefficients (Gauss coefficients) in Schmidt semi-normalized form for
the external magnetic field applied to the planet in gauss.</p></li>
<li><p><strong>PlanetEqRadius</strong> (<em>double</em>) – Planet reference (equatorial) radius used in reporting spherical harmonic coefficients from
each reference.</p></li>
<li><p><strong>Nmax</strong> (<em>int</em>) – Maximum degree of spherical harmonic coefficients in the selected internal field model.</p></li>
<li><p><strong>NmaxExt</strong> (<em>int</em>) – Maximum degree of spherical harmonic coefficients in the external field model associated with
the selected internal field model, if applicable. Set to zero if the model does not include
external field coefficients.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="getmodelopts">
<h3><a class="reference internal" href="#functions.GetModelOpts" title="functions.GetModelOpts"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code></a><a class="headerlink" href="#getmodelopts" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetModelOpts">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetModelOpts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">planet</span></em>, <em class="sig-param"><span class="pre">opt</span></em>, <em class="sig-param"><span class="pre">MPopt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetModelOpts" title="Permalink to this definition"></a></dt>
<dd><p>Convert from an index number to a compatible combination of planetary field models.</p>
<p>For each planet, only specific internal and external magnetic field models are mutually
compatible, as some are derived using parallel assumptions or outputs from other models. For
ease of implementation, this function provides an index-based lookup to select from among valid
model combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planet</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of planet for which to return model combination parameters.</p></li>
<li><p><strong>opt</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – <p>Index number for magnetospheric field model. 0 selects the default model, typically the most
recently, or most widely accepted, published model combination. Currently implemented model
combinations are:</p>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Earth</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): IGRF-13 from Alken et al. (2021)
<a class="reference external" href="https://doi.org/10.1186/s40623-020-01288-x">https://doi.org/10.1186/s40623-020-01288-x</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Jupiter</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: VIP4 model from Connerney et al. (1998) <a class="reference external" href="https://doi.org/10.1029/97JA03726">https://doi.org/10.1029/97JA03726</a> +
Connerney et al. (1981) current sheet model <a class="reference external" href="https://doi.org/10.1029/JA086iA10p08370">https://doi.org/10.1029/JA086iA10p08370</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>: O6 model from Connerney (1992) <a class="reference external" href="https://core.ac.uk/download/pdf/83644007.pdf">https://core.ac.uk/download/pdf/83644007.pdf</a> +
Khurana (1997) current sheet model <a class="reference external" href="https://doi.org/10.1029/97JA00563">https://doi.org/10.1029/97JA00563</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code>: VIP4 model with O6 model dipole moment orientation + associated current sheet
model, together from Khurana and Schwarzl (2005) <a class="reference external" href="https://doi.org/10.1029/2004JA010757">https://doi.org/10.1029/2004JA010757</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code>: JRM09 model from Connerney et al. (2018) <a class="reference external" href="https://doi.org/10.1002/2018GL077312">https://doi.org/10.1002/2018GL077312</a>
+ Connerney et al. (2020) current sheet model <a class="reference external" href="https://doi.org/10.1029/2020JA028138">https://doi.org/10.1029/2020JA028138</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code>: JRM09 model from Connerney et al. (2018) <a class="reference external" href="https://doi.org/10.1002/2018GL077312">https://doi.org/10.1002/2018GL077312</a>
+ Connerney et al. (1981) current sheet model <a class="reference external" href="https://doi.org/10.1029/JA086iA10p08370">https://doi.org/10.1029/JA086iA10p08370</a>
This model combination is as applied in Vance et al. (2021)
<a class="reference external" href="https://doi.org/10.1029/2020JE006418">https://doi.org/10.1029/2020JE006418</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span></code>: VIP4 model from Connerney et al. (1998) <a class="reference external" href="https://doi.org/10.1029/97JA03726">https://doi.org/10.1029/97JA03726</a> +
Khurana (1997) current sheet model <a class="reference external" href="https://doi.org/10.1029/97JA00563">https://doi.org/10.1029/97JA00563</a> This model
combination is as applied in Seufert et al. (2011)
<a class="reference external" href="https://doi.org/10.1016/j.icarus.2011.03.017">https://doi.org/10.1016/j.icarus.2011.03.017</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">7</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): JRM33 model from Connerney et al. (2021)
<a class="reference external" href="https://doi.org/10.1029/2021JE007138">https://doi.org/10.1029/2021JE007138</a> + Connerney et al. (2020) current sheet model
<a class="reference external" href="https://doi.org/10.1029/2020JA028138">https://doi.org/10.1029/2020JA028138</a>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Saturn</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: Burton et al. (2010) model with degree-1 external field
<a class="reference external" href="https://doi.org/10.1029/2010GL045148">https://doi.org/10.1029/2010GL045148</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): Cassini 11 + corresponding current sheet model
<a class="reference external" href="https://doi.org/10.1126/science.aav6732">https://doi.org/10.1126/science.aav6732</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Uranus</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: Q3 model with degree-1 external field from Connerney et al. (1987)
<a class="reference external" href="https://doi.org/10.1029/JA092iA13p15329">https://doi.org/10.1029/JA092iA13p15329</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): AH5 model from Herbet (2009) <a class="reference external" href="https://doi.org/10.1029/2009JA014394">https://doi.org/10.1029/2009JA014394</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Neptune</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): O8 model from Connerney et al. (1992)
<a class="reference external" href="https://doi.org/10.1016/0273-1177(92)90394-D">https://doi.org/10.1016/0273-1177(92)90394-D</a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>MPopt</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – <p>Index number for magnetopause current magnetic field model. 0 selects the default option. If
any value is passed that does not correspond to a valid model index, no magnetopause current
magnetic field will be modeled. Currently implemented model options are:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Earth</span></code>: No magnetopause current magnetic field model is implemented.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Jupiter</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: Alexeev and Belenkaya (2005) model <a class="reference external" href="https://doi.org/10.5194/angeo-23-809-2005">https://doi.org/10.5194/angeo-23-809-2005</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): Engle (1992) model with no sunward or anti-sunward tilt
<a class="reference external" href="https://doi.org/10.1029/92JA02036">https://doi.org/10.1029/92JA02036</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code>: Engle (1992) model with sunward tilt
<a class="reference external" href="https://doi.org/10.1029/92JA02036">https://doi.org/10.1029/92JA02036</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code>: Engle (1992) model with anti-sunward tilt
<a class="reference external" href="https://doi.org/10.1029/92JA02036">https://doi.org/10.1029/92JA02036</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code>: Engle (1992) model  with Bode (1994) time-dependent
coefficients <a class="reference external" href="https://apps.dtic.mil/sti/citations/ADA284857">https://apps.dtic.mil/sti/citations/ADA284857</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Saturn</span></code>: No magnetopause current magnetic field model is implemented.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Uranus</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: Q3mp model from Herbet (2009) <a class="reference external" href="https://doi.org/10.1029/2009JA014394">https://doi.org/10.1029/2009JA014394</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): Arridge and Eggington (2021) box harmonic model
<a class="reference external" href="https://doi.org/10.1016/j.icarus.2021.114562">https://doi.org/10.1016/j.icarus.2021.114562</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Neptune</span></code>:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code>): Schulz and McNabb (1996) model <a class="reference external" href="https://doi.org/10.1029/95JA02987">https://doi.org/10.1029/95JA02987</a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>MagModel</strong> (<em>char, 1xD</em>) – Planet intrinsic field model.</p></li>
<li><p><strong>CsheetModel</strong> (<em>char, 1xE</em>) – Current sheet magnetic field model to apply, if applicable.</p></li>
<li><p><strong>MPmodel</strong> (<em>char, 1xF</em>) – Magnetopause current magnetic field model to apply, if applicable.</p></li>
<li><p><strong>magModelDescrip</strong> (<em>char, 1xG</em>) – Text description of magnetic field model combination for plot labels.</p></li>
<li><p><strong>fEnd</strong> (<em>char, 1xH</em>) – File name descriptor to append for model-specific outputs, such as excitation moments.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="getminmoondist">
<h3><a class="reference internal" href="#functions.GetMinMoonDist" title="functions.GetMinMoonDist"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetMinMoonDist()</span></code></a><a class="headerlink" href="#getminmoondist" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetMinMoonDist">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetMinMoonDist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sc</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">ets</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetMinMoonDist" title="Permalink to this definition"></a></dt>
<dd><p>Get distance from a target to the nearest major moon of a planetary system.</p>
<p>Uses loaded SPICE kernels to determine the distance from the target to the major moons of the
specified parent body at given ephemeris times (ETs). ETs are in terms of seconds relative to
J2000. Position vectors are evaluated in IAU coordinates for the parent body since we only
consider line-of-sight distance. Returns the distance to the nearest moon at each ET and the
radial distance to the parent body center of mass, both in km.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sc</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of target body (e.g. spacecraft) understood by SPICE when upper-cased.</p></li>
<li><p><strong>parentName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – <p>Name of parent body from which to determine relative distance to the target and for the moons
of this body. Must be one of the following:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Earth</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Jupiter</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Saturn</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Uranus</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Neptune</span></code></p></li>
</ul>
</div></blockquote>
<p>and have SPICE kernels present in the loaded kernel pool sufficient to determine all relative
locations.</p>
</p></li>
<li><p><strong>ets</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Ephemeris times in TDB seconds relative to J2000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rMinMoon_km</strong> (<em>double, 1xN</em>) – Radial distance from the target to the nearest major moon of the parent body in km.</p></li>
<li><p><strong>rPar_km</strong> (<em>double, 1xN</em>) – Radial distance from the target to the parent body in km.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="getposspice">
<h3><a class="reference internal" href="#functions.GetPosSpice" title="functions.GetPosSpice"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetPosSpice()</span></code></a><a class="headerlink" href="#getposspice" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetPosSpice">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetPosSpice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">t_h</span></em>, <em class="sig-param"><span class="pre">S3coords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetPosSpice" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve locations of a target relative to a parent body at specified ephemeris times.</p>
<p>Uses loaded SPICE kernels to determine the position of one body relative to another in a specific
coordinate system. If the coordinates are not passed, standard cartesian coordinates are
selected. Ephemeris times are passed in terms of hours relative to J2000.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of target body, which must match a code name understood by SPICE and present in the loaded
kernel pool when upper-cased. Can be any body loaded in the kernel pool for which sufficient
data is present to determine location relative to the parent.</p></li>
<li><p><strong>parentName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Name of parent body understood by SPICE when upper-cased.</p></li>
<li><p><strong>t_h</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Ephemeris times in TDB hours relative to J2000.</p></li>
<li><p><strong>S3coords</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE,</span> <span class="pre">optional</span></code></span>) – Standard (System III) coordinates to use for the parent body. Defaults to ULS for Uranus, NLS
for Neptune, or IAU_PARENT for any other parent body. Any coordinate system understood by SPICE
will return a result, but the first 3 return values from this function will only be converted
correctly into spherical coordinates if cartesian coordinates are specified. Magnetic field
model evaluations will only work correctly with the default coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r_km</strong> (<em>double, 1xN</em>) – Radii from parent body center of mass in km.</p></li>
<li><p><strong>theta_rad</strong> (<em>double, 1xN</em>) – Colatitude of positions relative to parent body spin pole in radians.</p></li>
<li><p><strong>phi_rad</strong> (<em>double, 1xN</em>) – East longitude of positions relative to IAU-defined parent body prime meridian in radians.</p></li>
<li><p><strong>xyz_km</strong> (<em>double, 3xN</em>) – Position vectors of target body for each time in the selected coordinates.</p></li>
<li><p><strong>S3coords</strong> (<em>char, 1xE</em>) – Coordinate system of position vectors.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="gettargetmoondist">
<h3><a class="reference internal" href="#functions.GetTargetMoonDist" title="functions.GetTargetMoonDist"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">GetTargetMoonDist()</span></code></a><a class="headerlink" href="#gettargetmoondist" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.GetTargetMoonDist">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">GetTargetMoonDist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sc</span></em>, <em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">ets</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.GetTargetMoonDist" title="Permalink to this definition"></a></dt>
<dd><p>Get distance between two targets at given ephemeris times.</p>
<p>Uses loaded SPICE kernels to determine the distance from the first target to the second in terms
of planetary equatorial radii of the second target. Planetary radius is as defined in the
last-loaded text PCK file. Ephemeris times are passed in terms of seconds relative to J2000.
Position vectors are evaluated in IAU coordinates for the parent body of the second target
because these coordinates are always defined in SPICE and we are only finding the line-of-sight
distance, so the coordinates don’t matter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sc</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of target body (e.g. spacecraft) understood by SPICE when upper-cased.</p></li>
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Name of target body from which to determine relative distance. Must match a code name
understood by SPICE and present in the loaded kernel pool when upper-cased. Can be any body
loaded in the kernel pool for which sufficient data is present to determine sc location
relative to this body AND for which a radius can be determined from loaded PCK files.</p></li>
<li><p><strong>parentName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE</span></code></span>) – Name of parent body understood by SPICE when upper-cased to use for evaluation of position
vectors.</p></li>
<li><p><strong>ets</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Ephemeris times in TDB seconds relative to J2000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>r_RM</strong> – Distance between target bodies in equatorial radii of the second target body (moonName).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="loadspice">
<h3><a class="reference internal" href="#functions.LoadSpice" title="functions.LoadSpice"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">LoadSpice()</span></code></a><a class="headerlink" href="#loadspice" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.LoadSpice">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">LoadSpice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">sc</span></em>, <em class="sig-param"><span class="pre">spiceDir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.LoadSpice" title="Permalink to this definition"></a></dt>
<dd><p>Load SPICE kernels needed to determine positions for an input spacecraft and target moon.</p>
<p>Loads into the SPICE kernel pool all those kernels needed to evaluate spacecraft and moon
positions relative to the parent planet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – <p>Name of target body. Currently implemented options are:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Moon</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Io</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Europa</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ganymede</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Callisto</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Mimas</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Enceladus</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dione</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Rhea</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Titan</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Miranda</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ariel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Umbriel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Titania</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Oberon</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Triton</span></code></p></li>
</ul>
</div></blockquote>
<p>and their parent planets. The same binary kernels are loaded for any body within a particular
planetary system, as these kernels contain information for all listed satellites and the
planet.</p>
</p></li>
<li><p><strong>sc</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – <p>Spacecraft name for which trajectories will be loaded from relevant binary SPICE kernels.
Currently implemented options are:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Swarm</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Galileo</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Juno</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Voyager</span> <span class="pre">1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Voyager</span> <span class="pre">2</span></code></p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>spiceDir</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE,</span> <span class="pre">default='spice'</span></code></span>) – Directory where SPICE kernel files are located.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>parentName</strong> – Name of the parent body.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>char, 1xF</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="lshelltrace">
<h3><a class="reference internal" href="#functions.LshellTrace" title="functions.LshellTrace"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">LshellTrace()</span></code></a><a class="headerlink" href="#lshelltrace" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.LshellTrace">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">LshellTrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">parentName</span></em>, <em class="sig-param"><span class="pre">opt</span></em>, <em class="sig-param"><span class="pre">MPopt</span></em>, <em class="sig-param"><span class="pre">DO_MPAUSE</span></em>, <em class="sig-param"><span class="pre">sc</span></em>, <em class="sig-param"><span class="pre">t_h</span></em>, <em class="sig-param"><span class="pre">Nmaxin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.LshellTrace" title="Permalink to this definition"></a></dt>
<dd><p>Determine the L shell of the target body at specified ephemeris times.</p>
<p>Trace magnetic field line from the location of a target (e.g. a spacecraft) to the magnetic
dipole equator to determine the radial distance in planetary radii to the planet’s center of mass
at that location, also known as the L shell.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>This function is a work in progress and does not work correctly yet.</strong></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parentName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Parent body name recognized by SPICE. Sufficient kernels must be loaded in the pool to
determine the location of the target relative to this body at each ephemeris time.</p></li>
<li><p><strong>opt</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – Magnetospheric field model option selection. 0 selects the default model—see <code class="xref py py-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code> for
more details.</p></li>
<li><p><strong>MPopt</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – Magnetopause current magnetic field model option selection. 0 selects the default model—see
<code class="xref py py-func docutils literal notranslate"><span class="pre">GetModelOpts()</span></code> for more details.</p></li>
<li><p><strong>DO_MPAUSE</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to include magnetopause currents in the magnetic field model.</p></li>
<li><p><strong>sc</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD</span></code></span>) – Target body for which to evaluate L shells.</p></li>
<li><p><strong>t_h</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Ephemeris times to evaluate in TDB hours relative to J2000.</p></li>
<li><p><strong>Nmaxin</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">int,</span> <span class="pre">default=Inf</span></code></span>) – Spherical harmonic degree to which to limit magnetic field model evaluation in tracing field
lines. Using the default (Inf) makes use of the highest degree both implemented in <code class="xref py py-func docutils literal notranslate"><span class="pre">MagFldParent()</span></code>
and present in the model coefficients.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>L</strong> – L shell of each evaluation spacetime point for the target.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="plotspectrum">
<h3><a class="reference internal" href="#functions.PlotSpectrum" title="functions.PlotSpectrum"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">PlotSpectrum()</span></code></a><a class="headerlink" href="#plotspectrum" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.PlotSpectrum">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">PlotSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">moonName</span></em>, <em class="sig-param"><span class="pre">LIVE_PLOTS</span></em>, <em class="sig-param"><span class="pre">dataDir</span></em>, <em class="sig-param"><span class="pre">fPattern</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.PlotSpectrum" title="Permalink to this definition"></a></dt>
<dd><p>Plot a pre-saved spectrum of magnetic oscillations as derived from an FFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moonName</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Name of the moon for which to plot a spectrum. An FFT data file must be present.</p></li>
<li><p><strong>LIVE_PLOTS</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">bool,</span> <span class="pre">default=0</span></code></span>) – Whether to load interactive figure windows for plots (true) or print them to disk (false).</p></li>
<li><p><strong>dataDir</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xD,</span> <span class="pre">default='out'</span></code></span>) – Directory where data files are saved.</p></li>
<li><p><strong>fPattern</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xE,</span> <span class="pre">default='FTdata'</span></code></span>) – Pattern used for saved FFT data file names.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="rotatevecspice">
<h3><a class="reference internal" href="#functions.RotateVecSpice" title="functions.RotateVecSpice"><code class="xref mat mat-func docutils literal notranslate"><span class="pre">RotateVecSpice()</span></code></a><a class="headerlink" href="#rotatevecspice" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="functions.RotateVecSpice">
<span class="sig-prename descclassname"><span class="pre">functions.</span></span><span class="sig-name descname"><span class="pre">RotateVecSpice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Vx</span></em>, <em class="sig-param"><span class="pre">Vy</span></em>, <em class="sig-param"><span class="pre">Vz</span></em>, <em class="sig-param"><span class="pre">ets</span></em>, <em class="sig-param"><span class="pre">coordSource</span></em>, <em class="sig-param"><span class="pre">coordDest</span></em><span class="sig-paren">)</span><a class="headerlink" href="#functions.RotateVecSpice" title="Permalink to this definition"></a></dt>
<dd><p>Rotate vectors from one SPICE frame to another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Vx</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – x-aligned component of vectors to be rotated from the source frame to the destination frame.</p></li>
<li><p><strong>Vy</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – y-aligned component of vectors to be rotated from the source frame to the destination frame.</p></li>
<li><p><strong>Vz</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – z-aligned component of vectors to be rotated from the source frame to the destination frame.</p></li>
<li><p><strong>ets</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Ephemeris times (ETs) in TDB seconds relative to J2000 for each vector to rotate.</p></li>
<li><p><strong>coordSource</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Source frame, with coordinate axes to which the input vectors are referenced.</p></li>
<li><p><strong>coordDest</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">char,</span> <span class="pre">1xC</span></code></span>) – Destination frame, with coordinate axes to which the output vectors are referenced.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>VxMoon, VyMoon, VzMoon</strong> – Cartesian components of vectors in the destination frame for each input ET.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 1xN</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-modelCoeffs.printIGRFcoeffs">
<span id="model-coefficient-functions"></span><h2>Model coefficient functions<a class="headerlink" href="#module-modelCoeffs.printIGRFcoeffs" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modelCoeffs.printIGRFcoeffs.printIGRFcoeffs">
<span class="sig-prename descclassname"><span class="pre">modelCoeffs.printIGRFcoeffs.</span></span><span class="sig-name descname"><span class="pre">printIGRFcoeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fNameIn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'IGRF13.shc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fNameOut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coeffsEarthIGRF13'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datDir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'modelCoeffs'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelCoeffs.printIGRFcoeffs.printIGRFcoeffs" title="Permalink to this definition"></a></dt>
<dd><p>Convert IGRF-13 spherical harmonic coefficients described in IGRF13.shc to a PlanetMag-compatible
format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fNameIn</strong> (<em>str</em><em>, </em><em>default='IGRF13.shc'</em>) – File name for table of spherical harmonics</p></li>
<li><p><strong>fNameOut</strong> (<em>str</em><em>, </em><em>default='coeffsEarthIGRF13'</em>) – File name base for output .csv files (one for g, one for h)</p></li>
<li><p><strong>datDir</strong> (<em>str</em>) – Relative directory path where fNameIn is found and to which fNameOut will be printed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="coeffsbode1994g">
<h3><code class="xref py py-func docutils literal notranslate"><span class="pre">coeffsBode1994G()</span></code><a class="headerlink" href="#coeffsbode1994g" title="Permalink to this heading"></a></h3>
<dl class="mat function">
<dt class="sig sig-object mat" id="modelCoeffs.coeffsBode1994G">
<span class="sig-prename descclassname"><span class="pre">modelCoeffs.</span></span><span class="sig-name descname"><span class="pre">coeffsBode1994G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">alpha</span></em><span class="sig-paren">)</span><a class="headerlink" href="#modelCoeffs.coeffsBode1994G" title="Permalink to this definition"></a></dt>
<dd><p>Calculate Jupiter magnetopause field coefficients as fit by Bode (1994).</p>
<p>For use with Engle (1992) method as a function of dipole “precession angle” alpha for Jupiter.
See <a class="reference external" href="https://apps.dtic.mil/sti/pdfs/ADA284857.pdf">https://apps.dtic.mil/sti/pdfs/ADA284857.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">double,</span> <span class="pre">1xN</span></code></span>) – Nod longitude for planetary dipole moment in degrees. This is the angle between the equatorial
projection of the magnetic dipole moment vector and the direction of the Sun.
<code class="docutils literal notranslate"><span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">0</span></code> is when the the dipole nod longitude is at local noon.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Gnm</strong> – Numerical coefficients that describe the fit by Bode (1994) for each dipole angle alpha in the
time series to be modeled.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double, 10x11xN</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="primary.html" class="btn btn-neutral float-left" title="PlanetMag Matlab run scripts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pythonModules.html" class="btn btn-neutral float-right" title="PlanetMag Python documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, California Institute of Technology.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>